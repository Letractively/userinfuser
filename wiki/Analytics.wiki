#summary Engagement Analytics
#labels Featured,Phase-Design,Fanstasm,GoogleAppEngine,Analytics

= Introduction =

This section describes what analytics are currently supported, how they are calculated in a distributed manner, and what additional analytics are to come.  

= Current Support =
  * Number of API calls made
  * Number of points awarded
  * Number of badges awarded
  * Number of badge points awarded
    * This metric gives the most information because each badge can be associated with an important metric (i.e, referrals) 

= Analytics using Fantasm =
For each API call made to UserInfuser, a log is created. Every badge awarded, every point granted, every widget viewed (and so on) is logged and timestamped. Each day a background process is started to tally up the previous day's events. Google App Engine has very limited capabilities for doing complex SQL statements. They only allow for select statements (no JOINs, MERGES, COUNT functionality). To handle large quantities of logs UserInfuser uses [http://code.google.com/p/fantasm/ fantasm]. 

== Fantasm ==
Fantasm is a fantastic library for App Engine which allows applications to abstract away TaskQueues (background tasks in App Engine) to perform distributed processing of entities. The developer must specify a workflow as a finite state machine, and do so in YAML. Here is one of the state machines used by UserInfuser:

{{{
- name: CountAwardedBadges

  states:

  - name: CountAwardedBadgeInitState
    initial: True
    action: serverside.analytics.AllAccountsClass
    continuation: True
    final: True
    transitions:
    - event: peraccount
      to: PerAccountState
   
  - name: PerAccountState
    action: serverside.analytics.PerAccountClass
    continuation: True
    final: True
    transitions:
    - event: perbadge
      to: PerBadgeState

  - name: PerBadgeState
    action: serverside.analytics.PerBadgeClass
    continuation: True
    final: True
    transitions:
    - event: count
      to: CountAwardedBadgesState
    
  - name: CountAwardedBadgesState
    action: serverside.analytics.CountAwardedBadgesClass
    final: True

}}}

Fantasm also uses the Google Chart API to visualize your state machine:
[http://i.imgur.com/alXw0.png]

= More Analytics to Come =
  * Daily user logins
  * Clicks on notifications
  * Total number of users
  * Total number of points/badges/badge points

Email support@cloudcaptive.com for additional suggestions.